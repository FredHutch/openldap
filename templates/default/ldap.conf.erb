#
# Generated by Chef for <%= node.name %>
#

host <%= node['openldap']['server'] %>
port <%= node['openldap']['port'] %>

# Where to find data
base <%= node['openldap']['basedn'] %>
scope sub
nss_base_passwd ou=<%= node['openldap']['passwd_ou'] %>,<%= node['openldap']['basedn'] %>
nss_base_shadow ou=<%= node['openldap']['shadow_ou'] %>,<%= node['openldap']['basedn'] %>
nss_base_group ou=<%= node['openldap']['group_ou'] %>,<%= node['openldap']['basedn'] %>
nss_base_automount ou=<%= node['openldap']['automount_ou'] %>,<%= node['openldap']['basedn'] %>

<% if node['openldap']['tls_enabled'] -%>
# TLS Options
ssl start_tls
<% if node['openldap']['tls_checkpeer'] -%>
tls_checkpeer yes
<% else -%>
tls_checkpeer no
<% end -%>
<% end -%>

<% node['openldap']['client_config_hash'].each do |key, value| -%>
<%   case value -%>
<%   when nil -%>
<%= key %>
<%   when Array -%>
<%= key %>
<%     value.each do |v| -%>
  <%= v %>
<%     end -%>
<%   when String, Integer -%>
<%=    key %> <%= value %>
<%   end -%>
<% end -%>
